<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Boot Admin 및 Actuator 커스텀 엔드포인트 문서</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        p {
            line-height: 1.6;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-left: 4px solid #2c3e50;
            overflow-x: auto;
        }
        .code {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Spring Boot Admin 및 Actuator 커스텀 엔드포인트 문서</h1>

    <h2>1. 개요</h2>
    <p>
        <strong>Spring Boot Admin</strong>을 이용한 애플리케이션 모니터링 구현,
        <strong>Actuator 커스텀 엔드포인트</strong> 생성 방법, 그리고 <strong>Flyway</strong>를 활용한
        데이터 변경 관리 계획에 대해 다룹니다.
    </p>

    <h2>2. Spring Boot Admin 설명 및 구현</h2>
    
    <h3>2.2 Spring Boot Admin이란?</h3>
    <p>Spring Boot Admin은 Spring Boot Actuator에서 제공하는 정보를 보기 좋게 접근 가능한 방식으로<br>
     시각화하는 것을 목표로 하는 모니터링 도구입니다. <br>
     security 설정을 통해 모니터링 정보에 아무나 접근할 수 없도록 할 수 있습니다.<br>

Spring Boot Admin은 두 가지 주요 부분으로 구성됩니다.<br>

Server : Spring Boot Actuator를 표시하고 상호 작용하기 위한 사용자 인터페이스를 제공하는 서버<br>
Client : 서버에 등록하고 actuator 엔드포인트에 액세스하는데 사용되는 클라이언트</p>

    <h3>2.2 Spring Boot Admin 서버 설정</h3>
    <p>모니터링 서버를 생성하려면 아래 의존성을 추가합니다:</p>
    <pre><code class="code">
&lt;dependency&gt;
    &lt;groupId&gt;de.codecentric&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt;
    &lt;version&gt;3.3.3&lt;/version&gt;
&lt;/dependency&gt;
    </code></pre>

    <p>어노테이션을 이용해 스프링 어드민 서버 설정을 해줍니다</p>
    <pre><code class="code">
@SpringBootApplication
@EnableAdminServer
public class AdminServerApplication {

	public static void main(String[] args) {
		SpringApplication.run(AdminServerApplication.class, args);
	}

}
    </code></pre>


    <h3>2.3 클라이언트 애플리케이션 연결</h3>
    <p>클라이언트 애플리케이션 의존성 및 설정</p>
    <pre><code class="code">
&lt;dependency&gt;
    &lt;groupId&gt;de.codecentric&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-admin-starter-client&lt;/artifactId&gt;
    &lt;version&gt;3.3.3&lt;/version&gt;
&lt;/dependency&gt;

spring.boot.admin.client.url=http://localhost:9000
management.endpoint.shutdown.enabled=true
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
    </code></pre>

    <h2>3. Actuator 커스텀 엔드포인트(클라이언트)</h2>
    
    <h3>3.1 Actuator 설정</h3>
    <p>클라이언트 actuator 의존성 및 설정</p>
    <pre><code class="code">
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;artifactId&gt;
&lt;/dependency&gt;
</code></pre>

    <h3>3.2 커스텀 엔드포인트 생성</h3>
    <p>@Endpoint 애너테이션을 사용하여 커스텀 엔드포인트를 구현합니다</p>
    <pre><code class="code">
@Endpoint(id = "custom")
@Component
public class CustomActuatorEndpoint {

    @ReadOperation
    public Object customEndPoint() {
        Map&lt;String, String&gt; map = new HashMap&lt;&gt;();
        map.put("key", "value");
        return map;
    }
}
    </code></pre>
    
    <p>HealthIndicator 등을 구현합니다</p>
    <pre><code class="code">
@Component
public class DatabaseService implements HealthIndicator {

	private final String DATABASE_SERVICE = "DatabaseService";

	@Override
	public Health health() {
		if (isDatabaseHealthGood()) {
			return Health.up().withDetail(DATABASE_SERVICE, "Service is running").build();
		}
		return Health.down().withDetail(DATABASE_SERVICE, "Service is not available").build();
	}

	private boolean isDatabaseHealthGood() {
		// logic
		return true;
	}
}
    </code></pre>

    <h3>3.3 엔드포인트 노출</h3>
    <p>Actuator 노출 설정에 포함되도록 보장합니다</p>
    <pre><code class="code">
management.endpoints.web.exposure.include=*
    </code></pre>

    <h3>3.4 엔드포인트 테스트</h3>
    <p>브라우저로 엔드포인트에 접근합니다</p>
    <pre><code class="code">
curl http://localhost:8888/custom
    </code></pre>

    <h2>4. Liquibase를 활용한 데이터 변경 관리</h2>
    
        <h3>4.2 Liquibase 소개</h3>
    <p>
Liquibase는 Changelog를 통해 데이터베이스의 변경사항을 순차적으로 관리합니다.<br>
Changelog의 형식은 각기 다른 데이터베이스에 구애받지 않기 위해 SQL만을 이용하는 Flyway와 달리<br> 
SQL, XML, JSON, YAML로 구성되어있습니다.<br>

    </p>

    <h3>4.2 Liquibase 소개</h3>
    <p>
Liquibase는 Changelog를 통해 데이터베이스의 변경사항을 순차적으로 관리합니다.<br>
Changelog의 형식은 각기 다른 데이터베이스에 구애받지 않기 위해 SQL만을 이용하는 Flyway와 달리<br> 
SQL, XML, JSON, YAML로 구성되어있습니다.<br>

    </p>

    <h2>5. 결론</h2>
    <p>
        Spring Boot Admin을 활용한 애플리케이션 모니터링, 특정 애플리케이션 요구에 맞는<br>
        커스텀 Actuator 엔드포인트 생성 협조, Liquibase를 이용한 데이터베이스 스키마 변경 관리를 할 예정입니다.
    </p>
</body>
</html>
